package utils

import (
	"fmt"
	"log"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestGenRandomID(t *testing.T) {
	SetupIDWorker(1)

	t.Log(GenSpecIDStr(), len(GenSpecIDStr()))
}

func Test_ParseAcceptLanguage(t *testing.T) {
	res := ParseAcceptLanguage("zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7")
	t.Log(res)
}

func Test_Crypt(t *testing.T) {
	// 密钥和明文
	key := []byte("examplekey123456")
	plaintext := []byte("Sensitive Data to be encrypted")

	// 加密
	ciphertext, err := EncryptCFB(plaintext, key)
	if err != nil {
		log.Fatalf("加密失败: %v", err)
	}
	fmt.Printf("加密后的数据: %s\n", ciphertext)

	// 解密
	decrypted, err := DecryptCFB(ciphertext, key)
	if err != nil {
		log.Fatalf("解密失败: %v", err)
	}
	fmt.Printf("解密后的数据: %s\n", string(decrypted))

	assert.Equal(t, plaintext, decrypted)
}

func TestConverSVGToPNG(t *testing.T) {
	_, err := ConvertSVGToPNG([]byte(`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="1280.000000pt" height="1280.000000pt" viewBox="0 0 1280.000000 1280.000000"
 preserveAspectRatio="xMidYMid meet">
<metadata>
Created by potrace 1.15, written by Peter Selinger 2001-2017
</metadata>
<g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2150 12023 c-198 -31 -354 -79 -498 -152 -171 -85 -273 -158 -406
-289 -225 -222 -367 -481 -438 -799 -30 -135 -33 -483 -4 -613 140 -645 607
-1110 1246 -1241 147 -30 413 -33 555 -7 337 63 620 212 855 451 411 417 553
1029 369 1588 -186 562 -686 978 -1272 1058 -74 10 -352 13 -407 4z"/>
<path d="M6130 12010 c-869 -154 -1440 -994 -1264 -1860 60 -295 207 -564 428
-786 411 -411 988 -560 1546 -399 263 75 497 219 696 428 497 519 571 1321
178 1924 -240 371 -618 619 -1051 693 -151 26 -385 26 -533 0z"/>
<path d="M10215 12015 c-546 -86 -1011 -457 -1213 -970 -190 -481 -132 -1022
156 -1450 393 -584 1123 -834 1792 -614 471 155 847 535 998 1009 59 185 67
245 67 480 -1 183 -4 229 -23 313 -70 313 -204 562 -425 785 -240 244 -528
391 -872 447 -109 18 -367 18 -480 0z"/>
<path d="M2193 7959 c-540 -52 -1026 -390 -1258 -874 -248 -517 -197 -1130
133 -1595 85 -120 241 -276 362 -363 164 -116 387 -216 579 -257 303 -66 623
-39 912 75 458 181 818 590 939 1065 203 796 -245 1616 -1022 1875 -218 72
-425 96 -645 74z"/>
<path d="M6245 7959 c-267 -28 -533 -128 -752 -282 -113 -79 -291 -257 -370
-370 -338 -481 -383 -1097 -116 -1619 77 -151 161 -266 288 -393 271 -271 589
-419 984 -456 197 -19 441 13 640 83 117 41 283 127 388 201 113 79 291 257
370 370 384 546 384 1268 0 1814 -79 113 -257 291 -370 370 -310 218 -695 320
-1062 282z"/>
<path d="M10305 7959 c-573 -60 -1067 -424 -1290 -950 -165 -390 -165 -828 0
-1218 292 -691 1043 -1081 1775 -922 603 132 1069 602 1202 1214 19 88 22 132
22 317 0 239 -14 332 -75 507 -242 690 -920 1126 -1634 1052z"/>
<path d="M2164 3889 c-607 -71 -1128 -499 -1312 -1079 -59 -186 -67 -245 -67
-480 1 -183 4 -229 23 -313 71 -318 213 -578 438 -799 220 -216 470 -350 781
-421 85 -19 127 -22 318 -21 187 0 234 3 315 21 290 65 551 202 760 399 554
523 648 1376 222 2009 -326 485 -902 751 -1478 684z"/>
<path d="M6227 3890 c-382 -48 -701 -208 -963 -483 -497 -519 -571 -1321 -178
-1924 240 -370 619 -619 1052 -694 154 -26 370 -26 525 1 504 86 934 412 1152
873 174 368 198 777 69 1166 -180 542 -645 943 -1214 1046 -102 19 -349 27
-443 15z"/>
<path d="M10277 3890 c-592 -68 -1114 -491 -1302 -1054 -271 -812 147 -1685
945 -1974 186 -67 331 -92 542 -92 420 0 800 156 1097 452 221 220 363 481
433 795 30 136 33 483 4 613 -69 320 -211 586 -430 804 -231 231 -500 375
-813 436 -123 24 -354 34 -476 20z"/>
</g>
</svg>
`))
	if err != nil {
		t.Fatal(err)
	}
}
